<!-- 社交网络案例 -->
<div class="tutorial-content" id="social-network">
    <div class="mb-6">
        <h1 class="text-3xl font-bold text-gray-900 mb-2">社交网络案例</h1>
        <p class="text-lg text-gray-600">通过具体案例深入理解图在社交网络中的应用</p>
    </div>

    <!-- 学习目标 -->
    <div class="bg-blue-50 border-l-4 border-blue-400 p-4 mb-6">
        <h3 class="text-lg font-semibold text-blue-900 mb-2">📚 学习目标</h3>
        <ul class="text-blue-800 space-y-1">
            <li>• 理解社交网络的图表示方法</li>
            <li>• 掌握图分析的基本指标</li>
            <li>• 了解社交网络分析的应用价值</li>
            <li>• 学会从图的角度思考问题</li>
        </ul>
    </div>

    <!-- 案例介绍 -->
    <section class="mb-8">
        <h2 class="text-2xl font-bold text-gray-900 mb-4">📱 微信朋友圈：一个真实的社交网络</h2>
        
        <div class="bg-gradient-to-r from-green-50 to-blue-50 border rounded-lg p-6 mb-6">
            <h3 class="font-semibold text-gray-900 mb-3">场景描述</h3>
            <p class="text-gray-700 mb-4">
                想象你的微信朋友圈：每个人都是一个节点，好友关系就是连接节点的边。
                这个网络中蕴含着丰富的信息和模式。
            </p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="bg-white p-4 rounded border">
                    <h4 class="font-medium text-green-900 mb-2">节点 = 用户</h4>
                    <p class="text-sm text-gray-600">每个微信用户就是图中的一个节点</p>
                    <p class="text-xs text-green-600 mt-1">包含：姓名、头像、地理位置等信息</p>
                </div>
                
                <div class="bg-white p-4 rounded border">
                    <h4 class="font-medium text-blue-900 mb-2">边 = 好友关系</h4>
                    <p class="text-sm text-gray-600">用户之间的好友关系就是图中的边</p>
                    <p class="text-xs text-blue-600 mt-1">特点：通常是双向的（互为好友）</p>
                </div>
            </div>
        </div>
    </section>

    <!-- 交互式社交网络图 -->
    <section class="mb-8">
        <h2 class="text-2xl font-bold text-gray-900 mb-4">🎯 交互式社交网络可视化</h2>
        
        <div class="bg-white border rounded-lg p-6 mb-4">
            <div id="social-network-graph" class="w-full h-80 bg-gray-50 rounded mb-4">
                <!-- 这里会通过JavaScript生成交互式图 -->
                <div class="flex items-center justify-center h-full">
                    <div class="text-center">
                        <svg class="w-16 h-16 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                        </svg>
                        <p class="text-gray-600">点击下方按钮加载社交网络图</p>
                        <button id="load-social-graph" class="mt-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                            加载社交网络图
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                <div class="text-center">
                    <div class="w-4 h-4 bg-blue-500 rounded-full mx-auto mb-1"></div>
                    <span class="text-gray-600">普通用户</span>
                </div>
                <div class="text-center">
                    <div class="w-4 h-4 bg-red-500 rounded-full mx-auto mb-1"></div>
                    <span class="text-gray-600">意见领袖</span>
                </div>
                <div class="text-center">
                    <div class="w-4 h-4 bg-green-500 rounded-full mx-auto mb-1"></div>
                    <span class="text-gray-600">活跃用户</span>
                </div>
            </div>
        </div>
    </section>

    <!-- 图分析指标 -->
    <section class="mb-8">
        <h2 class="text-2xl font-bold text-gray-900 mb-4">📊 社交网络分析指标</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- 度数分析 -->
            <div class="bg-white border rounded-lg p-6">
                <h3 class="font-semibold text-gray-900 mb-3">🔢 度数 (Degree)</h3>
                <p class="text-gray-600 text-sm mb-3">表示一个用户有多少个好友</p>
                
                <div class="space-y-3">
                    <div class="flex justify-between items-center">
                        <span class="text-sm text-gray-700">社交达人</span>
                        <span class="text-sm font-medium text-blue-600">500+ 好友</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-sm text-gray-700">普通用户</span>
                        <span class="text-sm font-medium text-green-600">50-200 好友</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-sm text-gray-700">内向用户</span>
                        <span class="text-sm font-medium text-gray-600">< 50 好友</span>
                    </div>
                </div>
                
                <div class="mt-4 p-3 bg-blue-50 rounded text-xs text-blue-800">
                    💡 高度数节点往往是社交网络中的"枢纽"
                </div>
            </div>
            
            <!-- 中心性分析 -->
            <div class="bg-white border rounded-lg p-6">
                <h3 class="font-semibold text-gray-900 mb-3">🎯 中心性 (Centrality)</h3>
                <p class="text-gray-600 text-sm mb-3">衡量节点在网络中的重要性</p>
                
                <div class="space-y-3">
                    <div class="border-l-4 border-red-400 pl-3">
                        <h4 class="text-sm font-medium text-gray-900">度中心性</h4>
                        <p class="text-xs text-gray-600">好友数量最多的人</p>
                    </div>
                    <div class="border-l-4 border-yellow-400 pl-3">
                        <h4 class="text-sm font-medium text-gray-900">介数中心性</h4>
                        <p class="text-xs text-gray-600">最常作为"桥梁"的人</p>
                    </div>
                    <div class="border-l-4 border-green-400 pl-3">
                        <h4 class="text-sm font-medium text-gray-900">接近中心性</h4>
                        <p class="text-xs text-gray-600">到其他人"距离"最近的人</p>
                    </div>
                </div>
            </div>
            
            <!-- 聚类系数 -->
            <div class="bg-white border rounded-lg p-6">
                <h3 class="font-semibold text-gray-900 mb-3">🔗 聚类系数</h3>
                <p class="text-gray-600 text-sm mb-3">衡量"朋友的朋友也是朋友"的程度</p>
                
                <div class="bg-gray-50 p-3 rounded mb-3">
                    <p class="text-xs text-gray-700 mb-2">公式：</p>
                    <p class="text-sm font-mono text-gray-800">C = 实际三角形数 / 可能三角形数</p>
                </div>
                
                <div class="space-y-2 text-sm">
                    <div class="flex justify-between">
                        <span>高聚类（0.8+）</span>
                        <span class="text-green-600">紧密社群</span>
                    </div>
                    <div class="flex justify-between">
                        <span>低聚类（< 0.3）</span>
                        <span class="text-blue-600">开放网络</span>
                    </div>
                </div>
            </div>
            
            <!-- 路径长度 -->
            <div class="bg-white border rounded-lg p-6">
                <h3 class="font-semibold text-gray-900 mb-3">📏 路径长度</h3>
                <p class="text-gray-600 text-sm mb-3">任意两人之间的最短社交距离</p>
                
                <div class="bg-yellow-50 border border-yellow-200 p-3 rounded mb-3">
                    <h4 class="text-sm font-semibold text-yellow-900">六度分隔理论</h4>
                    <p class="text-xs text-yellow-800">世界上任意两人通过6个中间人就能建立联系</p>
                </div>
                
                <div class="text-sm space-y-1">
                    <p><strong>1度：</strong> 直接好友</p>
                    <p><strong>2度：</strong> 朋友的朋友</p>
                    <p><strong>3度：</strong> 朋友的朋友的朋友</p>
                    <p class="text-gray-500">...</p>
                </div>
            </div>
        </div>
    </section>

    <!-- 社群发现 -->
    <section class="mb-8">
        <h2 class="text-2xl font-bold text-gray-900 mb-4">👥 社群发现</h2>
        
        <div class="bg-gradient-to-r from-purple-50 to-pink-50 border rounded-lg p-6 mb-4">
            <h3 class="font-semibold text-gray-900 mb-3">什么是社群？</h3>
            <p class="text-gray-700 mb-4">
                社群是图中联系紧密的节点群体，比如同学群、同事群、兴趣小组等。
                社群内部连接密集，社群之间连接稀疏。
            </p>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="bg-white p-4 rounded border">
                    <h4 class="font-medium text-purple-900 mb-2">🎓 学校社群</h4>
                    <p class="text-sm text-gray-600">同班同学、室友关系形成的密集连接</p>
                </div>
                
                <div class="bg-white p-4 rounded border">
                    <h4 class="font-medium text-blue-900 mb-2">💼 工作社群</h4>
                    <p class="text-sm text-gray-600">同事之间的职业关系网络</p>
                </div>
                
                <div class="bg-white p-4 rounded border">
                    <h4 class="font-medium text-green-900 mb-2">🎨 兴趣社群</h4>
                    <p class="text-sm text-gray-600">共同爱好者形成的圈子</p>
                </div>
            </div>
        </div>
    </section>

    <!-- 实际应用 -->
    <section class="mb-8">
        <h2 class="text-2xl font-bold text-gray-900 mb-4">🚀 社交网络分析的应用</h2>
        
        <div class="space-y-4">
            <div class="bg-white border rounded-lg p-4">
                <h3 class="font-semibold text-gray-900 mb-2">📈 营销推广</h3>
                <p class="text-gray-600 text-sm mb-2">找到影响力最大的用户进行精准营销</p>
                <div class="text-xs text-blue-600">例子：微博大V推广、KOL营销</div>
            </div>
            
            <div class="bg-white border rounded-lg p-4">
                <h3 class="font-semibold text-gray-900 mb-2">🎯 个性化推荐</h3>
                <p class="text-gray-600 text-sm mb-2">基于好友关系推荐内容、商品或新朋友</p>
                <div class="text-xs text-blue-600">例子：微信"可能认识的人"</div>
            </div>
            
            <div class="bg-white border rounded-lg p-4">
                <h3 class="font-semibold text-gray-900 mb-2">🛡️ 风险控制</h3>
                <p class="text-gray-600 text-sm mb-2">检测虚假账号、欺诈行为和异常模式</p>
                <div class="text-xs text-blue-600">例子：支付宝风控、反欺诈</div>
            </div>
            
            <div class="bg-white border rounded-lg p-4">
                <h3 class="font-semibold text-gray-900 mb-2">📊 舆情监控</h3>
                <p class="text-gray-600 text-sm mb-2">追踪信息传播路径和影响范围</p>
                <div class="text-xs text-blue-600">例子：热点话题传播分析</div>
            </div>
        </div>
    </section>

    <!-- 案例分析 -->
    <section class="mb-8">
        <h2 class="text-2xl font-bold text-gray-900 mb-4">🔍 案例分析：信息传播</h2>
        
        <div class="bg-white border rounded-lg p-6">
            <h3 class="font-semibold text-gray-900 mb-3">场景：一条朋友圈动态的传播</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
                <div class="text-center">
                    <div class="w-8 h-8 bg-red-500 rounded-full mx-auto mb-2 flex items-center justify-center text-white font-bold text-sm">A</div>
                    <p class="text-xs text-gray-600">原创者</p>
                    <p class="text-xs text-red-600">发布内容</p>
                </div>
                <div class="text-center">
                    <div class="w-8 h-8 bg-yellow-500 rounded-full mx-auto mb-2 flex items-center justify-center text-white font-bold text-sm">B</div>
                    <p class="text-xs text-gray-600">一度传播</p>
                    <p class="text-xs text-yellow-600">点赞转发</p>
                </div>
                <div class="text-center">
                    <div class="w-8 h-8 bg-green-500 rounded-full mx-auto mb-2 flex items-center justify-center text-white font-bold text-sm">C</div>
                    <p class="text-xs text-gray-600">二度传播</p>
                    <p class="text-xs text-green-600">继续扩散</p>
                </div>
                <div class="text-center">
                    <div class="w-8 h-8 bg-blue-500 rounded-full mx-auto mb-2 flex items-center justify-center text-white font-bold text-sm">D</div>
                    <p class="text-xs text-gray-600">三度传播</p>
                    <p class="text-xs text-blue-600">病毒式传播</p>
                </div>
            </div>
            
            <div class="bg-gray-50 p-4 rounded">
                <h4 class="font-medium text-gray-900 mb-2">传播模式分析</h4>
                <ul class="text-sm text-gray-600 space-y-1">
                    <li>• <strong>线性传播：</strong> A → B → C → D（链式传播）</li>
                    <li>• <strong>星形传播：</strong> A → B,C,D（中心化传播）</li>
                    <li>• <strong>网状传播：</strong> 多路径同时传播（最高效）</li>
                </ul>
            </div>
        </div>
    </section>

    <!-- 思考与练习 -->
    <section class="mb-8">
        <h2 class="text-2xl font-bold text-gray-900 mb-4">🤔 思考与练习</h2>
        
        <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-4">
            <h3 class="font-semibold text-yellow-900 mb-3">练习题</h3>
            <ol class="text-yellow-800 space-y-2 list-decimal list-inside">
                <li>分析你的微信好友网络，找出其中的不同社群</li>
                <li>思考：为什么"网红"在社交网络中具有特殊地位？</li>
                <li>设计一个算法来找到社交网络中的意见领袖</li>
                <li>分析疫情期间"健康码"的社交网络追踪原理</li>
            </ol>
        </div>
        
        <div class="bg-green-50 border-l-4 border-green-400 p-4">
            <h3 class="font-semibold text-green-900 mb-3">💡 关键收获</h3>
            <ul class="text-green-800 space-y-1">
                <li>• 社交网络是图论在现实中的完美应用</li>
                <li>• 图分析能揭示隐藏的社交模式</li>
                <li>• 网络结构决定了信息传播的效率</li>
                <li>• 理解网络特性有助于设计更好的算法</li>
            </ul>
        </div>
    </section>

    <!-- 导航按钮 -->
    <div class="flex justify-between items-center pt-6 border-t border-gray-200">
        <div>
            <button data-action="show-tutorial" data-tutorial="intro-graphs" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors">
                ← 上一节：什么是图？
            </button>
        </div>
        <div class="text-center">
            <span class="text-sm text-gray-500">第2节 共12节</span>
        </div>
        <div>
            <button data-action="show-tutorial" data-tutorial="graph-basics" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                下一节：图的基本概念 →
            </button>
        </div>
    </div>
</div>

<script>
// 加载社交网络图的JavaScript代码
document.addEventListener('DOMContentLoaded', function() {
    const loadButton = document.getElementById('load-social-graph');
    if (loadButton) {
        loadButton.addEventListener('click', function() {
            loadSocialNetworkGraph();
        });
    }
});

function loadSocialNetworkGraph() {
    const container = document.getElementById('social-network-graph');
    if (!container || !window.d3) {
        container.innerHTML = '<p class="text-center text-gray-500 py-8">需要加载 D3.js 库来显示图表</p>';
        return;
    }
    
    container.innerHTML = '';
    
    const width = container.clientWidth;
    const height = 320;
    
    const svg = d3.select(container)
        .append('svg')
        .attr('width', width)
        .attr('height', height);
    
    // 社交网络数据
    const nodes = [
        {id: 0, name: '张三', type: 'normal', group: 0},
        {id: 1, name: '李四', type: 'influencer', group: 0},
        {id: 2, name: '王五', type: 'active', group: 0},
        {id: 3, name: '赵六', type: 'normal', group: 1},
        {id: 4, name: '钱七', type: 'normal', group: 1},
        {id: 5, name: '孙八', type: 'influencer', group: 1},
        {id: 6, name: '周九', type: 'active', group: 2},
        {id: 7, name: '吴十', type: 'normal', group: 2},
        {id: 8, name: '郑一', type: 'normal', group: 2},
        {id: 9, name: '王二', type: 'active', group: 0}
    ];
    
    const links = [
        {source: 0, target: 1}, {source: 0, target: 2}, {source: 0, target: 9},
        {source: 1, target: 2}, {source: 1, target: 3}, {source: 1, target: 5},
        {source: 2, target: 9}, {source: 3, target: 4}, {source: 3, target: 5},
        {source: 4, target: 5}, {source: 5, target: 6}, {source: 6, target: 7},
        {source: 6, target: 8}, {source: 7, target: 8}
    ];
    
    const colorScale = {
        'normal': '#3b82f6',
        'influencer': '#ef4444',
        'active': '#10b981'
    };
    
    const simulation = d3.forceSimulation(nodes)
        .force('link', d3.forceLink(links).id(d => d.id).distance(80))
        .force('charge', d3.forceManyBody().strength(-200))
        .force('center', d3.forceCenter(width / 2, height / 2));
    
    const link = svg.append('g')
        .selectAll('line')
        .data(links)
        .enter().append('line')
        .attr('stroke', '#94a3b8')
        .attr('stroke-width', 2);
    
    const node = svg.append('g')
        .selectAll('circle')
        .data(nodes)
        .enter().append('circle')
        .attr('r', d => d.type === 'influencer' ? 12 : 8)
        .attr('fill', d => colorScale[d.type])
        .attr('stroke', '#ffffff')
        .attr('stroke-width', 2)
        .call(d3.drag()
            .on('start', dragstarted)
            .on('drag', dragged)
            .on('end', dragended));
    
    const label = svg.append('g')
        .selectAll('text')
        .data(nodes)
        .enter().append('text')
        .text(d => d.name)
        .attr('font-size', '10px')
        .attr('text-anchor', 'middle')
        .attr('dy', 25)
        .attr('fill', '#374151');
    
    node.append('title')
        .text(d => `${d.name} (${d.type})`);
    
    simulation.on('tick', () => {
        link
            .attr('x1', d => d.source.x)
            .attr('y1', d => d.source.y)
            .attr('x2', d => d.target.x)
            .attr('y2', d => d.target.y);
        
        node
            .attr('cx', d => d.x)
            .attr('cy', d => d.y);
            
        label
            .attr('x', d => d.x)
            .attr('y', d => d.y);
    });
    
    function dragstarted(event, d) {
        if (!event.active) simulation.alphaTarget(0.3).restart();
        d.fx = d.x;
        d.fy = d.y;
    }
    
    function dragged(event, d) {
        d.fx = event.x;
        d.fy = event.y;
    }
    
    function dragended(event, d) {
        if (!event.active) simulation.alphaTarget(0);
        d.fx = null;
        d.fy = null;
    }
}
</script>
